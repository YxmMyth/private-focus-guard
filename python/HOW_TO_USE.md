# FocusGuard 使用指南

## 🚀 快速开始

### 步骤1：启动应用
```bash
cd python
python ui/main_window.py
```

### 步骤2：设置专注目标（重要！）
在"专注会话设置"区域填写：
- **专注目标**：例如"修复Bug，完成单元测试"
- **允许范围**：例如"VSCode, StackOverflow, GitHub"（可选）

### 步骤3：开始专注会话（必须！）
点击"🚀 开始专注会话"按钮

### 步骤4：启动监控
点击"▶️ 启动监控"按钮

---

## ⚠️ 为什么没有弹窗提醒？

### 原因：没有创建专注会话！

**错误使用方式：**
```
1. 启动应用 ✅
2. 直接点"启动监控" ✅
3. 打开YouTube等黑名单网站 ✅
4. 期待弹窗提醒 ❌
```
**结果**：只会状态栏显示警告，不会弹窗！

**正确使用方式：**
```
1. 启动应用 ✅
2. 填写专注目标 ✅
3. 点"开始专注会话" ✅  ← 关键！
4. 点"启动监控" ✅
5. 打开黑名单网站 ✅
6. 触发弹窗干预 ✅
```

---

## 📊 容忍度机制（三振出局）

### 默认级别（级别3）
- **阈值**：40分（累计分心值）
- **上限**：5次strikes
- **衰减**：10分钟

### 触发流程
```
第1次分心（score=7.0）
  → 总分：7.0
  → Strikes：1/5
  → 状态栏警告："⚡ YouTube | 7.0/10"

第2次分心（score=8.0）
  → 总分：15.0
  → Strikes：2/5
  → 状态栏警告："⚡ YouTube | 8.0/10"

...

第5次分心 OR 总分超过40分
  → **弹出干预对话框！**
  → 与你辩论："你真的在看YouTube吗？"
```

---

## 🎮 实际测试步骤

### 测试1：验证规则判决
1. 启动应用
2. **不要**创建专注会话
3. 启动监控
4. 打开YouTube
5. 查看状态栏：应该显示"⚠️ 分心: msedge.exe | 7.0/10"

### 测试2：验证弹窗干预
1. 启动应用
2. **填写专注目标**："测试专注"
3. **点击"开始专注会话"**
4. 启动监控
5. 连续打开5次分心网站（或等到总分>40）
6. 应该**弹出干预对话框**

---

## 💡 调试技巧

### 查看日志
状态栏会显示实时判断信息：
- `✅ VSCode | 符合目标 | 开发工具` → 正常
- `⚡ YouTube | 7.0/10 | URL包含分心关键词` → 警告
- `⚠️ 分心: Bilibili | 8.0/10 | 检测到分心应用` → 高危

### 查看数据库
```bash
# 数据库位置
C:\Users\你的用户名\.focusguard\data\focusguard.db

# 使用DB Browser for SQLite打开查看
# 表：focus_sessions（会话记录）
# 表：activities（活动记录）
# 表：judgments（判决记录）
```

---

## 🔧 调整容忍度

如果觉得太严格或太宽松，可以修改：
`python/services/tolerance_service.py`

```python
TOLERANCE_LEVELS = {
    1: {'name': '严格', 'threshold': 20, 'strike_limit': 3},
    2: {'name': '较严', 'threshold': 30, 'strike_limit': 3},
    3: {'name': '默认', 'threshold': 40, 'strike_limit': 5},  # 当前默认
    4: {'name': '宽松', 'threshold': 50, 'strike_limit': 5},
    5: {'name': '很宽松', 'threshold': 60, 'strike_limit': 7},
}
```

---

## ❓ 常见问题

**Q: 为什么打开YouTube没弹窗？**
A: 需要先点击"开始专注会话"！

**Q: strikes是什么？**
A: 分心次数计数器，类似"三振出局"

**Q: 如何立即触发干预？**
A: 打开tolerance_service.py，把threshold改为10

**Q: 监控会消耗多少性能？**
A: 极低，每3秒检测一次窗口（几毫秒）

---

**记住：专注会话是核心功能！没有它就没有真正的监督。**
